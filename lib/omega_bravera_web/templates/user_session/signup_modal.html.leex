<%= form_for @changeset, "#", [phx_change: :validate, phx_submit: :signup, as: :user], fn f -> %>
<%= if @open_modal do %>
  <div class="live-modal modal fade show" data-backdrop="true" id="signUpModal" tabindex="-1" role="dialog" aria-labelledby="signUpModalLabel" style="display: block;">
<% else %>
  <div class="live-modal modal fade" data-backdrop="true" id="signUpModal" tabindex="-1" role="dialog" aria-labelledby="signUpModalLabel" aria-hidden="true">
<% end %>
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <%= unless @signup_ok? do %>

          <div class="modal-header">
            <h5 class="modal-title mx-auto" id="signUpModalLabel"><%= gettext("Signup") %></h5>
          </div>

          <div class="modal-body">
            <div class="row mx-auto align-items-center">
              <span class="big-logo mx-auto"></span>
            </div>

            <div class="row mx-auto align-items-center">
              <span class="mx-auto"><%= gettext("Email Signup") %></span>
            </div>

            <div class="container">

              <div class="form-group mt-2">
                <%= if @open_modal do %>
                  <%= text_input f, :firstname, class: add_error_class(f, :firstname, "form-control signup-modal-input"), placeholder: gettext("First name"), required: "" %>
                <% else %>
                  <%= text_input f, :firstname, class: add_error_class(f, :firstname, "form-control signup-modal-input"), placeholder: gettext("First name"), required: "", disabled: "disabled" %>
                <% end %>

                <%= error_tag f, :firstname %>
              </div>

              <div class="form-group mt-2">
                <%= if @open_modal do %>
                  <%= text_input f, :lastname, class: add_error_class(f, :lastname, "form-control signup-modal-input"), placeholder: gettext("Last name"), required: "" %>
                <% else %>
                  <%= text_input f, :lastname, class: add_error_class(f, :lastname, "form-control signup-modal-input"), placeholder: gettext("Last name"), required: "", disabled: "disabled" %>
                <% end %>

                <%= error_tag f, :lastname %>
              </div>

              <div class="form-group mt-2">
                <%= if @open_modal do %>
                  <%= email_input f, :email, class: add_error_class(f, :email, "form-control signup-modal-input"), placeholder: gettext("Email"), required: "" %>
                <% else %>
                  <%= email_input f, :email, class: add_error_class(f, :email, "form-control signup-modal-input"), placeholder: gettext("Email"), required: "", disabled: "disabled" %>
                <% end %>

                <%= error_tag f, :email %>
              </div>
              <div class="form-group mt-2">
                <%= select f, :location_id, Enum.map(@locations, &{&1.name_en, &1.id}), class: "form-control signup-modal-input" %>
                <%= error_tag f, :location_id %>
              </div>

              <%= inputs_for f, :credential, fn fp -> %>
                <div class="row mx-auto">
                  <%= if @open_modal do %>
                    <%= password_input fp, :password, value: input_value(fp, :password), class: add_error_class(fp, :password, "form-control signup-modal-input"), placeholder: gettext("Password"), required: "" %>
                  <% else %>
                      <%= password_input fp, :password, value: input_value(fp, :password), class: add_error_class(fp, :password, "form-control signup-modal-input"), placeholder: gettext("Password"), required: "", disabled: "disabled" %>
                  <% end %>
                  
                  <%= error_tag fp, :password %>
                </div>
                <div class="row mx-auto mt-2">
                  <%= if @open_modal do %>
                    <%= password_input fp, :password_confirmation, value: input_value(fp, :password_confirmation), class: add_error_class(fp, :password_confirmation, "form-control signup-modal-input"), placeholder: gettext("Confirm your password"), required: "" %>
                  <% else %>
                      <%= password_input fp, :password_confirmation, value: input_value(fp, :password_confirmation), class: add_error_class(fp, :password_confirmation, "form-control signup-modal-input"), placeholder: gettext("Confirm your password"), required: "", disabled: "disabled" %>
                  <% end %>
                  
                  <%= error_tag fp, :password_confirmation %>
                </div>
              <% end %>

              <div class="row mx-auto mt-4 mb-3 text-muted text-center small form-check">
                <%= checkbox f, :accept_terms, class: add_error_class(f, :accept_terms, "form-check-input") %>
                <label class="form-check-label">
                  <%= gettext("By signing-up you agree to our") %>
                  <a href="https://www.bravera.fit/terms" target="_blank" rel="noreferrer noopener"><%= gettext("Terms") %></a>
                  <span>&nbsp;&&nbsp;</span>
                  <a href="https://www.bravera.fit/privacy" target="_blank" rel="noreferrer noopener"><%= gettext("Cookies/Privacy Policy") %></a>
                </label>
              </div>

            </div>

          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-bravera mr-auto" data-dismiss="modal" data-toggle="modal" data-target="#loginModal" data-ga-track-click="Sign In BTN From Signup Modal"><%= gettext("Sign in") %></button>

            <button type="button" class="btn btn-secondary" data-dismiss="modal" phx-click="close_modal" data-ga-track-click="Close Modal BTN From Signup Modal"><%= gettext("Cancel") %></button>
            <button type="submit" class="btn btn-bravera" phx-disable-with="<%= gettext("Signing up..") %>" <%= unless @signup_button_disabled?, do: " disabled" %> data-ga-track-click="Sign Up BTN From Signup Modal"><%= gettext("Join Now") %></button>
          </div>
        <% else %>
          <div class="modal-header">
            <h5 class="modal-title mx-auto" id="signUpModalLabel"><%= gettext("Signup Sucessful") %></h5>
          </div>

          <div class="modal-body">
            <div class="row mx-auto align-items-center">
              <span class="big-logo mx-auto"></span>
            </div>

            <div class="row mx-auto align-items-center">
              <span class="d-block mt-3 mb-3 mx-auto text-center"><strong><%= gettext("Please check your email") %></strong></span>
            </div>

            <div class="row mx-auto align-items-center">
              <%= img_tag(static_path(OmegaBraveraWeb.Endpoint, "/images/modals/ellipse1.png"), alt: "Check your email", class: "mx-auto") %>
            </div>

            <div class="row mx-auto align-items-center">
              <span class="d-block mt-3 mb-3 mx-auto text-center"><%= gettext("Click on the link that has been sent to your email address to complete your registration.") %></span>
            </div>

          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-bravera mx-auto" data-dismiss="modal" phx-click="close_modal" data-ga-track-click="Close Modal BTN From Signup Modal"><%= gettext("Ok") %></button>
          </div>
        <% end %>

      </div>
    </div>
  </div>
<% end %>
